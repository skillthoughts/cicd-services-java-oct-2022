pipeline
{
agent any
stages
{
stage('Checkout SCM')
{
   steps
   {
   script
   {
   git 'https://github.com/skillthoughts/cicd-services-java-oct-2022.git'
   }
   }
   }
stage('Maven Build')
{
   steps
   {
   script
   {
   sh "mvn clean package"
   }
  }
}
stage('Docker Image Build') {
      steps {
      script
      {
      withDockerRegistry(credentialsId: 'docker-reg-creds', url: 'https://index.docker.io/v1/') {
    sh 'docker build -t skillthoughts/tomcat:2.0 .'
    sh 'docker push skillthoughts/tomcat:2.0'
}
      }
      }
    }
}
}
